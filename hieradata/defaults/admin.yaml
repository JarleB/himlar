---
classes:
  - himlar::admin::profile

account::accounts:
  beddari:
    ssh_key: AAAAB3NzaC1yc2EAAAADAQABAAABAQDV5iURXYrx45xuyHkqlSaU/8WFF+z61YXvfjjV2gVBn9b7vFVFXjQ+Fo4GAUPd+jsv9qBgdWrqZTlVY/k0hrjMnZYOuEwAWQ58bXvFvlyY8FikwB1QxeTjH0wyjvGjZlqd8kruU8dwwzwQeAH3aehPNw2kb3OCsXVGp14t/hsJpHnbQwkjZX5tgAa2PV0GAhcDYaZBy31LJ4U9Qa644SKKGsKR26UKSq2LI/fep1v3oe2aNU5ixRtxKhtrdHnKl+/whqJjwAE4fC1PFMYMJnatzAYnwQ8OXWD4Vg7CU+bB/OXNu+vhpoHKibI089km6/3eT4USAhvu36HiwIFkb/sR
    groups:
      - wheel
      - users
  ebm:
    ssh_key: AAAAB3NzaC1yc2EAAAADAQABAAABAQCuZ40vEBzipAk1E3JZ47/Ck8DjL0lWDkYIFbJE5O9qYPj9a0lHX9ytpNztI1flZvJXFo7ZzAi8xkwoiWtFCZgwjrzTjmynV8TH4zaJx5Y7q9uD6mMG+fQ0pq7TbEnS7HBAbEtfWa7zdMza6YkTvromfgrynfxgjJQ4CX8QpDiH61Ohn2ev+mjfIbAeveamJxrUEBHt5n2m6FXsztGGdYgl5Wq1xPn7Tcsp7LCEZSh+najaxw+vJscEPf0MiedTIU9RkvPfDk8rA5g0xjlsprt/HwxlDnRjizujiMWS6JEdPXP3R7w2g3/6Lg5wFxQIXUgYOKjLq0QYNlaWP6B7LPbb
    groups:
      - wheel
      - users
  mikaeld:
    ssh_key: AAAAB3NzaC1yc2EAAAABIwAAAQEAu6LmtQMkPIpHmUeHbfdA0425xDSRZpArCq7KuTYRurQOWssrPhMIpAa6OV2LPkpRLF0YIbzoHEXSqkgNwo6F1Qhy7E0l8TnKO5JtuctJtWUzvdesVniUszsXOg7543ZuEaA4qr2EPZSaASOemcMhUgr29wiUKaZF1h8LOXb3za7OORuWR/FW++HfUlPssmWA3R0KtC7OLhkum7c2+59rCaNYFIBUuepKURxDOqYI9sm7TdMw6+dbRUSsqUX2ITlcHhOYp2ehpnG/PpfIN/WFChudhAIDFFgTBImDtJ3Rx1oG45PB1f+r+IIZ6hzndkjqxdlTWpaY4q3ZOeGSFgCJVw==
    groups:
      - wheel
      - users

ssh::server::options:
  # Need this for 2FA (saz-ssh-module disables by default)
  ChallengeResponseAuthentication: 'yes'
  # The second publickey is until the pam files are fixed
  AuthenticationMethods: 'publickey,keyboard-interactive:pam publickey'
  # Explicitly enable the required methods
  UsePAM: 'yes'
  PasswordAuthentication: 'yes'
  PubKeyAuthentication: 'yes'

googleauthenticator::pam::mode::modes:
  wheel-only:
    condition: 'user ingroup wheel'
    nullok: true

googleauthenticator::pam::modules:
  sshd:
    mode: wheel-only

sudo::configs:
  wheel:
    priority: 15
    content: '%wheel ALL=(ALL) NOPASSWD:ALL'

